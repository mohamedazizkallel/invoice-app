{% load static %}

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Invoicing System">
    <meta name="author" content="Swift Technology">
    <title>Invoice Online</title>

    <link href="{% static 'assets/css/bootstrap.min.css' %}" rel="stylesheet">
    <link href="{% static 'assets/css/dashboard.css' %}" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

    {% block css %}{% endblock %}

    <style>
      .toast-container {
        z-index: 2000;
      }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  </head>
  
<body>

  <header class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow">
    <a class="navbar-brand col-md-3 col-lg-2 me-0 px-3" href="#"> Invoice App</a>
    <button class="navbar-toggler position-absolute d-md-none collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarMenu">
      <span class="navbar-toggler-icon"></span>
    </button>
    <input class="form-control form-control-dark w-100" type="text" placeholder="Search">
    <div class="navbar-nav">
      <div class="nav-item text-nowrap">
        <a class="nav-link px-3" href="{% url 'logout' %}">Log Out</a>
      </div>
    </div>
  </header>

  <div class="container-fluid">
    <div class="row">
      <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
        <div class="position-sticky pt-3">
          <ul class="nav flex-column">
            <li class="nav-item"><a class="nav-link" href="{% url 'dashboard' %}">Dashboard</a></li>
            <li class="nav-item"><a class="nav-link" href="{% url 'invoices_list' %}">Invoices</a></li>
            <li class="nav-item"><a class="nav-link" href="{% url 'clients' %}">Clients</a></li>
            <li class="nav-item"><a class="nav-link" href="{% url 'services_list' %}">Services</a></li>
            <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted"> 
              <span>Settings</span> 
              <a class="link-secondary" href="#" aria-label="Add a new report"> 
                <span data-feather="plus-circle"></span> 
              </a> 
            </h6> 
            <ul class="nav flex-column mb-2"> 
              <li class="nav-item"> <a class="nav-link" href="{% url 'settings_view' %}"> 
                <span data-feather="file-text"></span> Company </a> 
              </li> 
              <li class="nav-item"> <a class="nav-link" href="#"> 
                <span data-feather="file-text"></span> SMTP </a> 
              </li> 
            </ul>
          </ul>
        </div>
      </nav>

      <!-- TOAST NOTIFICATIONS -->
      {% if messages %}
      <div aria-live="polite" aria-atomic="true" class="position-relative">
        <div class="toast-container position-fixed top-0 end-0 p-3">
          {% for message in messages %}
            <div class="toast align-items-center border-0 mb-2
              {% if message.tags == 'success' %} bg-success text-white
              {% elif message.tags == 'error' %} bg-danger text-white
              {% elif message.tags == 'warning' %} bg-warning text-dark
              {% else %} bg-info text-white
              {% endif %}"
              role="alert" data-bs-delay="3000">
              
              <div class="d-flex">
                <div class="toast-body">
                  {% if message.tags == 'success' %}<i class="bi bi-check-circle-fill me-2"></i>
                  {% elif message.tags == 'error' %}<i class="bi bi-x-circle-fill me-2"></i>
                  {% elif message.tags == 'warning' %}<i class="bi bi-exclamation-triangle-fill me-2"></i>
                  {% else %}<i class="bi bi-info-circle-fill me-2"></i>{% endif %}
                  {{ message }}
                </div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
      {% endif %}
      <!-- END TOAST -->

      {% block main %}{% endblock %}
    </div>
  </div>

  {% comment %} <script src="{% static 'assets/js/bootstrap.bundle.min.js' %}"></script> {% endcomment %}
  <script src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/feather.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
  <script src="{% static 'assets/js/dashboard.js' %}"></script>

  <script>
    // Auto-show all toasts
    document.addEventListener("DOMContentLoaded", function() {
      document.querySelectorAll('.toast').forEach(toastEl => {
        new bootstrap.Toast(toastEl).show();
      });
    });
  </script>

  {% block scripts %}{% endblock %}

</body>
</html>
